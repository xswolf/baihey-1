<script src="/wechat/web/js/config/area.js"></script>
<script src="/wechat/web/js/config/city.js"></script>

<div class="wrapper wrapper-content animated fadeInUp">
    <div class="ibox">
        <div class="ibox-title"><h5>会员列表</h5>
            <div class="ibox-tools rboor">
                <a href="/admin/member/save" class="btn btn-green btn-xs p310"><i class="fa fa-plus"></i> 添加</a>
                <button class="btn btn-green btn-xs p310 del-user"><i class="fa fa-trash-o"></i> 删除</button>
            </div>
        </div>

        <div class="ibox-content">

            <div class="form-horizontal clearfix">
                <form action="/admin/member/index" method="get">
                    <div class="col-sm-12">
                        <div class="box-body big">
                            <div class="row">
                                <div class="col-sm-2">
                                    <select name="status" class="form-control">
                                        <option value="">会员状态</option>
                                        <option {{if \Yii::$app->request->get('status') == 1}} selected {{/if}} value="1">未审核</option>
                                        <option {{if \Yii::$app->request->get('status') == 2}} selected {{/if}} value="2">已审核</option>
                                        <option {{if \Yii::$app->request->get('status') == 3}} selected {{/if}} value="3">黑名单</option>
                                        <option {{if \Yii::$app->request->get('status') == 4}} selected {{/if}} value="4">已删除</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select name="is_show" class="form-control">
                                        <option value="">资料状态</option>
                                        <option  {{if \Yii::$app->request->get('is_show') == 1}} selected {{/if}}value="1">开放</option>
                                        <option  {{if \Yii::$app->request->get('is_show') == '0'}} selected {{/if}}value="0">关闭</option>
                                    </select>
                                </div>
                                <div class="col-sm-3">
                                    <input type="text" name="id_phone_name" class="form-control" value="{{\Yii::$app->request->get('id_phone_name')}}" placeholder="会员ID、手机号、姓名">
                                </div>
                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">搜索</button>
                                </div>
                            </div>
                        </div>

                    </div>
                </form>
            </div>

            <table id="demo1" class="table  table-bordered    j-datatables"
                data-is-ajax="1"
                   data-ajax-url="/admin/member/search"
                   cellspacing="0" width="100%">
                <thead>
                <tr>
                    <th>头像</th>
                    <th>ID</th>
                    <th>姓名</th>
                    <th>性别</th>
                    <th>年龄</th>
                    <th>婚姻</th>
                    <th>身高</th>
                    <th>学历</th>
                    <th>等级</th>
                    <th>服务</th>
                    <th>认证</th>
                    <th>签单</th>
                    <th>资料</th>
                    <th>地址</th>
                    <th>证件</th>
                    <th>状态</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    jQuery(document).ready(function () {
        $('.j-datatables tbody').on( 'click', 'tr', function () {
            $(this).toggleClass('selected');
        } );

        $('.del-user').click(function () {
            if(confirm('确认删除')){
                var id = [];
                $('table .selected').each(function () {
                    id.push($(this).children().next().html());
                })

                $.ajax({ type:'post',
                    url: "/admin/member/del",
                    data:{id:id},
                    success: function(res){
                        res = JSON.parse(res);
                        if (res.status == 1) {
                            window.location.reload();
                        }
                    }
                });
            }

        })
    });
</script>