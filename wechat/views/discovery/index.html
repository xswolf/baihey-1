<ion-view>
    <link href="/wechat/web/css/discovery.css" rel="stylesheet">
    <link href="/wechat/web/js/plugin/amezeui/css/amazeui.min.css" rel="stylesheet">
    <link href="/wechat/web/css/plugin/animate/animate.css" rel="stylesheet">
    <ion-header-bar class="com_w_100 bhy">
        <title class="title">个人动态</title>
        <button class="button button-icon icon ion-plus-circled positive" ng-click="releasedOpen()"></button>
    </ion-header-bar>

    <ion-content class="com_w_100 bhy discovery bg5">
        <div class="list">
            <div class="mt10 item item-thumbnail-left" ng-repeat="dis in discoveryList | filter:indexFilter" >
                <img class="cp" ng-src="{{dis.head_pic | isNull}}" ng-click="jump('/userInfo?userId={{dis.user_id}}')" onerror="this.src='/wechat/web/images/no_img.png'">
                <h2>
                    <span class="fl">{{dis.name | sex:dis.sex:dis:age}}</span>
                    <span class="fr fs12 cor5">{{dis.create_time*1000 | date:'yyyy-MM-dd HH:mm'}}</span>
                </h2>
                <p>
                    <span class="identity id" ng-if="honesty(dis.honesty_value)">身份证</span>
                    <span class="identity phone" ng-if="dis.phone != null">手机</span>
                    <span class="identity vip" ng-if="dis.level == '1'">vip</span>
                    <span class="identity guest" ng-if="dis.level == 2">贵宾</span>
                    <span class="identity diamond" ng-if="dis.level == 3">钻石</span>
                </p>
                <p class="wsn">{{dis.content}}</p>
                <ul class="am-gallery am-avg-sm-3 am-avg-md-3 am-avg-lg-4 am-gallery-default"
                    data-am-widget="gallery" data-am-gallery="{pureview:true}">
                    <li ng-repeat="img in dis.imgList">
                        <div class="am-gallery-item">
                            <img src="{{img.thumb_path}}" data-rel="{{img.thumb_path | picture}}" alt=".">
                        </div>
                    </li>
                </ul>
                <div class="clearfix mt10 pr">
                    <span class="fl cp" ng-class="{true:'cor21',false:'cor53'}[dis.cid > 0]" click-like ng-click="clickLike(dis)">
                        <i class="ion-thumbsup fs20 vam"></i>
                        <span class="vam likeNumber dib">{{dis.like_num}}</span>
                    </span>
                    <span class="fl ml10 cp cor53" ng-click="jump('/discovery_single?id={{dis.id}}')">
                        <i class="ion-chatbubble-working fs20 vam"></i>
                        <span class="vam">{{dis.comment_num}}</span>
                    </span>
                    <span class="fr cp cor53" ng-click="more(dis.user_id==userInfo.user_id,dis.id,$index)">
                        <i class="ion-more fs20 vam"></i>
                    </span>
                </div>
            </div>
        </div>

        <ion-infinite-scroll
                ng-if="moreDataCanBeLoaded()"
                on-infinite="loadMore()"
                distance="1%">
        </ion-infinite-scroll>
    </ion-content>

    <script id="released.html" type="text/ng-template">
        <ion-modal-view>
            <ion-header-bar>
                <button class="button button-icon" ng-click="releasedClose()">取消</button>
                <h1 class="title">发布动态</h1>
                <button class="button button-icon cor21" ng-disabled="!formData.content" ng-click="saveData()">发布</button>
            </ion-header-bar>
            <ion-content class="bg5">
                <ion-list>
                    <ion-item class="mt10">
                        <div class="gallery_handle clearfix" data-am-widget="gallery" data-am-gallery="{pureview:true}">
                            <div class="imgItem" ng-repeat="img in imgList">
                                <img src="{{img.thumb_path}}" data-rel="{{img.thumb_path | picture}}">
                            </div>
                            <div class="imgItem add" ng-click="addNewImg()">
                                <i class="icon ion-plus-round"></i>
                            </div>
                        </div>
                        <textarea class="dis_taInput" placeholder="想说点什么？"
                                  ng-model="formData.content" maxlength="500"></textarea>
                    </ion-item>
                    <input id="pic_fileInput" type="file" nv-file-select="" uploader="uploader"
                           style="visibility: hidden; display: none;" accept="image/*">
                    <ion-radio ng-model="formData.auth" value="1">
                        完全公开
                    </ion-radio>
                    <ion-radio ng-model="formData.auth" value="2">
                        我关注的人可见
                    </ion-radio>
                    <ion-radio ng-model="formData.auth" value="3">
                        仅自己可见
                    </ion-radio>
                </ion-list>
            </ion-content>
        </ion-modal-view>
    </script>

    <script id="report.html" type="text/ng-template">
        <ion-modal-view ng-controller="discovery.released">
            <ion-header-bar>
                <button class="button button-icon" ng-click="reportClose()">关闭</button>
                <h1 class="title">动态举报</h1>
            </ion-header-bar>
            <ion-content class="bg5">
                <ion-radio ng-model="reportData.item" ng-value="'诽谤辱骂'">诽谤辱骂</ion-radio>
                <ion-radio ng-model="reportData.item" ng-value="'淫秽色情'">淫秽色情</ion-radio>
                <ion-radio ng-model="reportData.item" ng-value="'血腥暴力'">血腥暴力</ion-radio>
                <ion-radio ng-model="reportData.item" ng-value="'垃圾广告'">垃圾广告</ion-radio>
                <ion-radio ng-model="reportData.item" ng-value="'欺骗（酒托、话费托等骗取行为）'">欺骗（酒托、话费托等骗取行为）</ion-radio>
                <ion-radio ng-model="reportData.item" ng-value="'违法行为（涉毒、暴恐、违禁品等）'">违法行为（涉毒、暴恐、违禁品等）</ion-radio>
                <ion-radio ng-model="reportData.item" ng-value="'冒用他人照片'">冒用他人照片</ion-radio>
                <ion-radio ng-model="reportData.item" ng-value="'资料不真实'">资料不真实</ion-radio>
                <button class="button button-positive button-block" ng-click="report()" style="margin-top: 30px;">举报</button>
            </ion-content>
        </ion-modal-view>
    </script>

    <ion-footer-bar class="bar-stable">
        <a class="menuBtn" href="/wap/site/main#/index">
            <i class="icon-new-menu-home"></i>
            <p>首页</p>
        </a>
        <a class="menuBtn" href="/wap/site/main#/message">
            <i class="icon-new-menu-bubble">
                <span ng-if="msgNumber" class="msg_number">{{msgNumber}}</span>
            </i>
            <p>消息</p>
        </a>
        <a class="menuBtn" href="/wap/site/main#/member">
            <i class="icon-new-menu-user"></i>
            <p>个人</p>
        </a>
        <a class="menuBtn cur" href="/wap/site/main#/discovery">
            <i class="icon-new-menu-eye"></i>
            <p>发现</p>
        </a>
        <a class="menuBtn" href="/wap/site/main#/rendezvous">
            <i class="icon-new-menu-heart"></i>
            <p>约会</p>
        </a>
    </ion-footer-bar>
</ion-view>